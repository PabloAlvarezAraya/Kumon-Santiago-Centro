<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8">
	<title>HTML5 - Geolocation</title>
	<!--<script src="https://maps.googleapis.com/maps/api/js?libraries=places"></script>-->
	 <!-- GOOGLE MAPS-->
	<script src="http://maps.google.com/maps/api/js?key=https://puppetmaster9000.github.io/Pagina-Web/"></script>
	<!--<script type="text/javascript" src="http://www.maps.googleapis.com/maps/AIzaSyC6tW7sdTsJxB0N8QzSV4HVEaxaEXzXrhw/js?v3"></script>-->
	<!--<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD6bHlFrt4xu38Y4MNPfiZReogD4wyNSro&callback=initMap"
  type="text/javascript"></script>-->
</head>
<body>
	<h1>Mapa Interactivo</h1>
	<div id="mapa" style="width : 700px height: 500px;">
		--ACÁ VA EL MAPA--
	</div>
	<script type="text/javascript">
		//NAMESPACE --> google.maps.ALGO
		var divMapa = document.getElementById('mapa');
		navigator.geolocation.getCurrentPosition ( fn_ok, fn_mal );
			function fn_mal(){}
			function fn_ok( rta ){
				var lat = rta.coords.latitude;
				var lon = rta.coords.longitude;
				
				var glatLon = new google.maps.LatLng( lat, lon );
				var objConfig = {
					zoom : 17,
					center: glatLon
				}
				var gMapa = new google.maps.Map( divMapa, objConfig );
				var objConfigMarker = {
					//gLatLon
					//position: (-33.4075924, -70.5487675),
					position: glatLon,
					animation: google.maps.Animation.DROP,
					map: gMapa,
					draggable: true,
					title: 'Usted está aca'
				}
				
				var gMarker = new google.maps.Marker( objConfigMarker );
					//gMarker.setIcon( 'icon_usuario.gif' );
				
				var gCoder = new google.maps.Geocoder( );
				var objInformacion = {
					address: 'MCI Electronics Showroom, Providencia'
				}
				//objInformation.address
				gCoder.geocode( objInformacion, fn_coder );
					
				function fn_coder( datos ){
					var coordenadas = datos[0].geometry.location; 
					var config = {
						map: gMapa,
						animation: google.maps.Animation.DROP,
						position: coordenadas,
						title: 'Casa'
					}
					var gMarkerDV = new google.maps.Marker( config );
						gMarkerDV.setIcon( 'icon_edificio.png' ); para ver imagen en mapa
					var objHTML = {
						content: '<div style="height: 150px width: 300px"><h2>Mi Casa</h2><h3>Cerrado las 24hrs</h3><p>Informate <a href="http://www.google.cl">aca</a></p></div>'
					}	
					var gIW = new google.maps.InfoWindow( objHTML );
					
					google.maps.event.addListener( gMarkerDV, 'click', function(){
						gIW.open( gMapa, gMarkerDV );
					} );
				}
				var obConfigDR ={
					map: gMapa,
					suppressMarkers: true 
				}
				var obConfigDS ={
					origin: glatLon, // latLong - String de domicilio
					destination: objInformacion.address,
					travelMode: google.maps.TravelMode.DRIVING,
				}
				var ds = new google.maps.DirectionsService( ); // Obtener coordenadas
				var dr = new google.maps.DirectionsRenderer( objConfigDR ); // Traduce las coordenadas a la ruta visible A-->B
				
				ds.route( obConfigDS, fnRutear );
				
				function fnRutear( resultados, status ){
					// Mostrar la linea entre  A y B
					if( status == 'OK'){
						dr.setDirections( resultados );
					}else{
						alert( 'Error '+status );
					}
				}
				
			}
	</script>
</body>
</html>
